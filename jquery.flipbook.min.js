/* (c) 2012 Gerhut (Gerhut@GMail.com) || http://gerhut.net)
 * LastChangedDate: 2012-7-31 21:08:02 +0800 (Tue, 31 Jul 2012)
 * Version: 0.0.0
 * Requires: jQuery 1.4.3+
 */
(function($){$.flipbook={transform:"rotateY(90deg)",duration:"300"};$.fn.flipbook=function(s){var i=function(a,b){var c=a.data("onTop");var d=c+b;if(d<0||d>=a.children().length)return;a.children().eq(c).css("z-index",0);a.children().eq(d).css("z-index",1);a.data("flipping",false);var e=a.children().eq(c).clone().wrap("<div/>").parent();var f=a.children().eq(d).clone().wrap("<div/>").parent();var g=a.children().eq(c).clone().wrap("<div/>").parent();var h=a.children().eq(d).clone().wrap("<div/>").parent();h.css({"-webkit-transform":$.flipbook.transform,"-webkit-transition":"-webkit-transform "+$.flipbook.duration+"ms ease-out"}).add(g.css("-webkit-transition","-webkit-transform "+$.flipbook.duration+"ms ease-in")).css({"z-index":3}).add(e).add(f).css({position:"absolute",zIndex:2,width:a.outerWidth()/2,height:a.outerHeight(),overflow:"hidden","-webkit-transform-origin":"right center"});(b==-1?e.add(h):f.add(g)).offset({top:0,left:a.outerWidth()/2}).css("-webkit-transform-origin","left center").children().offset({top:0,left:-a.outerWidth()/2});a.append(e).append(f).append(g).append(h);setTimeout(function(){g.css("-webkit-transform",$.flipbook.transform);setTimeout(function(){h.css("-webkit-transform","");setTimeout(function(){e.add(f).add(g).add(h).remove();a.data({flipping:false,onTop:d})},$.flipbook.duration)},$.flipbook.duration)},10)};this.data({onTop:0,flipping:false}).children().css({position:"absolute",zIndex:0}).width(this.outerWidth()).height(this.outerHeight()).offset(this.offset()).click(this,function(a){if(!a.data.data("flipping")){if(a.offsetX<a.data.outerWidth()/2)i(a.data,-1);else i(a.data,1)}}).eq(this.data("onTop")).css("zIndex",1);return this}})(jQuery);